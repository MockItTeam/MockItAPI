<%
  def render_json(text)
    text.gsub!("\\n", "<br>")
    text = "<div>" + text.split(",").join("</div><div>") + "</div>"
    return text.html_safe
  end
%>

<h1>Admin</h1>
<h2>Mockups</h2>
<table>
  <tr>
    <th>id</th>
    <th>owner</th>
    <th>project</th>
    <th>raw</th>
    <th>created_at</th>
    <th>status</th>
    <th>elements</th>
    <th>message</th>
  </tr>
  <% @mockups.each do |mockup| %>
    <tr>
      <td><%= mockup.id %></td>
      <td><%= mockup.owner.username %></td>
      <td><%= mockup.project.name %></td>
      <td>
        <% if mockup.raw_image %>
          <%=  image_tag(mockup.raw_image.name, size: "50x50") %>
        <% else %>
          -
        <% end %>
  		</td>
      <td><%= time_ago_in_words(mockup.created_at) %></td>
      <td><%= mockup.status %></td>
      <td>
        <% if mockup.json_elements %>
          <%= render_json(mockup.json_elements) %>
        <% else %>
          -
        <% end %>
      </td>
      <td>
        <% if mockup.error_message %>
          <%= render_json(mockup.error_message) %>
        <% else %>
          -
        <% end %>
      </td>
  	</tr>
  <% end %>
</table>

<style>
  td, th {
    border: 1px solid #abcdef;
  }

  div {
    border: 1px solid #abcdef;
    display: inline-block;
    margin: 3px;
    padding: 1px;
  }
</style>